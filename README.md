# Air Supply

_You need data; Air Supply will get it to you._

Air Supply is a versatile library to handle get data from multiple sources in a sane way to use in your application build, data analysis, and whatever else you need.

[![npm version](https://img.shields.io/npm/v/air-supply.svg?style=flat-square)](https://www.npmjs.com/package/air-supply)
[![npm](https://img.shields.io/npm/dm/air-supply.svg?style=flat-square)](https://www.npmjs.com/package/air-supply)

- [Installation](#installation)
- [Usage](#usage)
- [Examples](#examples)
- [API Docs](#api)
- [Contribute](#contribute)

## Installation

`npm install air-supply --save`

If you just want to use the command-line version, install globally like: `npm install -g air-supply`

## Usage

Basic usage in Node:

```js
const { AirSupply } = require("air-supply");

// Create new AirSupply object and tell it about
// the packages it needs
let air = new AirSupply({
  packages: {
    someData: "http://example.com/data.json",
    otherData: {
      source: "spreadsheet-id",
      type: "google-sheet"
    }
  }
});

// Get the data, caching will happen by default
let data = await air.supply();
```

Command line usage with a `air-supply.rc` file:

```js
{
  packages: {
    cliData: "some-file.yml";
  }
}
```

```bash
air-supply -c air-supply.rc > data.json
```

## Examples

_TODO_

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

- [AirSupply](#airsupply)
- [AirSupply](#airsupply-1)
  - [Parameters](#parameters)
  - [supply](#supply)
    - [Parameters](#parameters-1)
  - [package](#package)
    - [Parameters](#parameters-2)
  - [guessPackageType](#guesspackagetype)
    - [Parameters](#parameters-3)
- [Packages](#packages)
- [File](#file)
  - [Parameters](#parameters-4)
  - [fetch](#fetch)
- [BasePackage](#basepackage)
  - [Parameters](#parameters-5)
  - [cachedFetch](#cachedfetch)
  - [transform](#transform)
  - [bundle](#bundle)
    - [Parameters](#parameters-6)

### AirSupply

### AirSupply

AirSupply class. The AirSupply class is the main way
of collecting data via AirSupply.

Any options given to AirSupply will be provided to packages
as defaults before their own default or your specific options.

#### Parameters

- `options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)?** Options object.
  - `options.ttl` **[Number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The global length of cache in milliseconds
  - `options.cachePath` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The location of the cache data, defaults
    to the .air-supply/ directory in the current working path.
  - `options.packages` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The object describing each package, in format:

#### supply

Bundles all the package data. This will use the options.packages provided to AirSupply
as well as any provided options.

##### Parameters

- `packages` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)?** An object describing packages. This is the same
  as the constructor option, but will not get attached to the AirSupply object
  for future reference. (optional, default `{}`)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)>** The compiled data.

#### package

Given a config, gets a package instance.

##### Parameters

- `config` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)!** An object for defining the package. This will be the options
  passed to the package object, plus the following necessary properties.
  - `config.type` **([String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)!)** This is either the package class name as a string,
    or directly passed the package class.
  - `config.key` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)!** The package key that helps assign the package to the
    bundled supply package.

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The instantiated package.

#### guessPackageType

Given a pcakage config, guess what the type is.

##### Parameters

- `config` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)!** A package config. (optional, default `{}`)

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The altered package config.

### Packages

### File

**Extends BasePackage**

File package type. Gets data from local files. Utilizes [indian-ocean](https://mhkeller.github.io/indian-ocean/)
to read multiple types of files and directories.

#### Parameters

- `options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)!** Options object to define options for this
  specific package adn override any defaults. See the global AirSupply
  options
  - `options.source` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)!** The path to the file or directory to read data from.
  - `options.noCache` **[Boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?** Turn caching off or leave on. (optional, default `true`)
  - `options.fetchOptions` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)?** Options object sent to [`re adDataSync`](https://mhkeller.github.io/indian-ocean/#readDataSync) or [`readdirFilterSync`](https://mhkeller.github.io/indian-ocean/#readdirFilterSync) if a directory.
- `airSupply` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)&lt;[AirSupply](#airsupply)>?** The AirSupply object useful for
  referencial purposes.

#### fetch

Fetch implementation. Utilizes [indian-ocean](https://mhkeller.github.io/indian-ocean/)
to read multiple types of files and directories.

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The fetched data.

### BasePackage

The base package class that is meant to be extended
for each package type class.

Do not use this class directly.

#### Parameters

- `options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)?** Options object to define options for this
  specific package adn override any defaults. See the global AirSupply
  options, as well as the specific package type options.
  - `options.keyIdentifiers` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)!** An array of properties in the options
    that will get used to create the cache key (optional, default `['key','source']`)
  - `options.cachePoint` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)!** A string the defines when caching will happen;
    the options are:
    \- fetch: Caching happens after fetch
    \- transform: Caching happens after the transform function is performed
    \- bundle: Caching happens after bundle function is preformed (optional, default `'fetch'`)
- `airSupply` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)&lt;[AirSupply](#airsupply)>?** The AirSupply object useful for
  referencial purposes.
- `packageDefaults` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)?** This is used for classes that extend this class, so
  that they can provid default options.

#### cachedFetch

Wrapper around the implemented fetch method. This will cache the result
if needed, and perform the transform method if needed as well.

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The fetched data.

#### transform

Transform fetch data.

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The transformed (or fetched if no transform) data.

#### bundle

Transform after all packages have been fetched and transformed. This should
be passed the full supply package

##### Parameters

- `supplyPackage` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The full supply package object of transformed
  packages.

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The bundled (or fetched or transformed) data.

## Contribute

## Test

Run tests with: `npm run test`
